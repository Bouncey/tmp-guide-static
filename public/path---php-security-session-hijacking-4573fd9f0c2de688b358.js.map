{"version":3,"sources":["webpack:///path---php-security-session-hijacking-4573fd9f0c2de688b358.js","webpack:///./.cache/json/php-security-session-hijacking.json"],"names":["webpackJsonp","./node_modules/json-loader/index.js!./.cache/json/php-security-session-hijacking.json","module","exports","data","markdownRemark","html","fields","slug","frontmatter","title","pathContext"],"mappings":"AAAAA,cAAc,qBAERC,wFACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,KAAA,mwJAA6vJC,QAAyMC,KAAA,oCAA0CC,aAAgBC,MAAA,uBAA8BC,aAAgBH,KAAA","file":"path---php-security-session-hijacking-4573fd9f0c2de688b358.js","sourcesContent":["webpackJsonp([3887531928137047600],{\n\n/***/ \"./node_modules/json-loader/index.js!./.cache/json/php-security-session-hijacking.json\":\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h2>Session Hijacking</h2>\\n<p>Session Hijacking is a vulnerability caused by an attacker gaining access to a user’s session identifier and being able to use another user’s account impersonating them. This is often used to gain access to an administrative user’s account.</p>\\n<h3>Defending against Session Hijacking attacks in PHP</h3>\\n<p>To defend against Session Hijacking attacks you need to check the current user’s browser and location information against information stored about the session. Below is an example implementation that can help mitigate the effects of a session hijacking attack. It checks the IP Address, User Agent, and if the Session Expired removing a session before it’s resumed.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-php\\\"><code><span class=\\\"token delimiter important\\\">&lt;?php</span>\\n<span class=\\\"token function\\\">session_start</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Does IP Address match?</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$_SERVER</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'REMOTE_ADDR'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'ipaddress'</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n<span class=\\\"token function\\\">session_unset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token function\\\">session_destroy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Does user agent match?</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$_SERVER</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'HTTP_USER_AGENT'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'useragent'</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">session_unset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token function\\\">session_destroy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Is the last access over an hour ago?</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">time</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'lastaccess'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3600</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">session_unset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token function\\\">session_destroy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">else</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'lastaccess'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">time</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h4>More Information:</h4>\\n<ul>\\n<li><a href=\\\"https://secure.php.net/manual/en/session.security.php\\\">php.net session security manual</a></li>\\n</ul>\",\"fields\":{\"slug\":\"/php/security/session-hijacking/\"},\"frontmatter\":{\"title\":\"Session Hijacking\"}}},\"pathContext\":{\"slug\":\"/php/security/session-hijacking/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---php-security-session-hijacking-4573fd9f0c2de688b358.js","module.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h2>Session Hijacking</h2>\\n<p>Session Hijacking is a vulnerability caused by an attacker gaining access to a user’s session identifier and being able to use another user’s account impersonating them. This is often used to gain access to an administrative user’s account.</p>\\n<h3>Defending against Session Hijacking attacks in PHP</h3>\\n<p>To defend against Session Hijacking attacks you need to check the current user’s browser and location information against information stored about the session. Below is an example implementation that can help mitigate the effects of a session hijacking attack. It checks the IP Address, User Agent, and if the Session Expired removing a session before it’s resumed.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-php\\\"><code><span class=\\\"token delimiter important\\\">&lt;?php</span>\\n<span class=\\\"token function\\\">session_start</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Does IP Address match?</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$_SERVER</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'REMOTE_ADDR'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'ipaddress'</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n<span class=\\\"token function\\\">session_unset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token function\\\">session_destroy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Does user agent match?</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$_SERVER</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'HTTP_USER_AGENT'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'useragent'</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">session_unset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token function\\\">session_destroy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Is the last access over an hour ago?</span>\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">time</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'lastaccess'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3600</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">session_unset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token function\\\">session_destroy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">else</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token variable\\\">$_SESSION</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'lastaccess'</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">time</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h4>More Information:</h4>\\n<ul>\\n<li><a href=\\\"https://secure.php.net/manual/en/session.security.php\\\">php.net session security manual</a></li>\\n</ul>\",\"fields\":{\"slug\":\"/php/security/session-hijacking/\"},\"frontmatter\":{\"title\":\"Session Hijacking\"}}},\"pathContext\":{\"slug\":\"/php/security/session-hijacking/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/php-security-session-hijacking.json\n// module id = ./node_modules/json-loader/index.js!./.cache/json/php-security-session-hijacking.json\n// module chunks = 3887531928137047600"],"sourceRoot":""}