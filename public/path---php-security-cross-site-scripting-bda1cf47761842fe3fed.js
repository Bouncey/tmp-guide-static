webpackJsonp([0x771f8204df2ed800],{"./node_modules/json-loader/index.js!./.cache/json/php-security-cross-site-scripting.json":function(n,s){n.exports={data:{markdownRemark:{html:'<h2>Cross Site Scripting</h2>\n<p>Cross Site Scripting is a type of vulnerability in a web application caused by the programmer not sanitizing input before outputting the input to the web browser (for example a comment on a blog). It is commonly used to run malicious javascript in the web browser to do attacks such as stealing session cookies among other malicious actions to gain higher level privileges in the web application.</p>\n<h3>Example Cross Site Scripting Attack</h3>\n<p>A blog allows users to style their comments with HTML tags, however the script powering the blog does not strip out <code>&#x3C;script></code> tags allowing any user to run javascript on the page. An attacker can use this to their advantage to run malicious javascript in the browser. They could infect users with malware, steal session cookies, and more.</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">\n  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">\'Cross Site Scripting!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<h3>Defending your website from cross site scripting attacks in PHP</h3>\n<p>In PHP there are two primary functions, <code>htmlspecialchars()</code> and <code>strip_tags()</code>, built in to protect yourself from cross site scripting attacks.</p>\n<p>The <code>htmlspecialchars($string)</code> function will prevent an HTML string from rendering as HTML and display it as plain text to the web browser.\n<strong>htmlspecialchars() code example</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-php"><code><span class="token delimiter important">&lt;?php</span>\n<span class="token variable">$usercomment</span> <span class="token operator">=</span> <span class="token string">"&lt;string>alert(\'Cross Site Scripting!\');&lt;/script>"</span><span class="token punctuation">;</span>\n<span class="token keyword">echo</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$usercomment</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>The other approach is the <code>strip_tags($string, $allowedtags)</code> function which removes all HTML tags except for the HTML tags that you’ve whitelisted. It’s important to note that with the <code>strip_tags()</code> function you have to be more careful, this function does not prevent the user from including javascript as a link, you’ll have to sanitize that on our own.</p>\n<p><strong>strip_tags() code example</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-php"><code><span class="token delimiter important">&lt;?php</span>\n<span class="token variable">$usercomment</span> <span class="token operator">=</span> <span class="token string">"&lt;string>alert(\'Cross Site Scripting!\');&lt;/script>"</span><span class="token punctuation">;</span>\n<span class="token variable">$allowedtags</span> <span class="token operator">=</span> <span class="token string">"&lt;p>&lt;a>&lt;h1>&lt;h2>&lt;h3>"</span><span class="token punctuation">;</span>\n<span class="token keyword">echo</span> <span class="token function">strip_tags</span><span class="token punctuation">(</span><span class="token variable">$usercomment</span><span class="token punctuation">,</span> <span class="token variable">$allowedtags</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><strong>Setting the X-XSS-Protection Header:</strong></p>\n<p>In PHP you can send the <code>X-XSS-Protection</code> Header which will tell browsers to check for a reflected Cross Site Scripting attack and block the page from loading. This does not prevent all cross site scripting attacks only reflected ones and should be used in combination with other methods.</p>\n<div class="gatsby-highlight">\n      <pre class="language-php"><code><span class="token delimiter important">&lt;?php</span>\n<span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"X-XSS-Protection: 1; mode=block"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><strong>Writing your own sanitization function</strong>\nAnother option, if you would like more control over how the sanitization works, is to write your own HTML Sanitization function, this is not recommended for PHP Beginners as a mistake would make your website vulnerable.</p>\n<h3>Defending your website from cross site scripting attacks with a Content Security Policy</h3>\n<p>An effective approach to preventing cross site scripting attacks, which may require a lot of adjustments to your web application’s design and code base, is to use a content security policy.</p>\n<h4>Set a Content Security Policy as an HTTP Header</h4>\n<p>The most common way of setting a Content Security Policy is by setting it directly in the HTTP Header. This can be done by the web server by editing it’s configuration or by sending it through PHP.</p>\n<p><strong>Example of a Content Security Policy set in a HTTP Header</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-php"><code><span class="token delimiter important">&lt;?php</span>\n<span class="token function">header</span><span class="token punctuation">(</span>"content<span class="token operator">-</span>security<span class="token operator">-</span>policy<span class="token punctuation">:</span> <span class="token keyword">default</span><span class="token operator">-</span>src <span class="token string">\'self\'</span><span class="token punctuation">;</span> img<span class="token operator">-</span>src https<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//*; child-src \'none\';");</span>\n</code></pre>\n      </div>\n<h4>Set a Content Security Policy as a Meta tags</h4>\n<p>You can include your Content Security Policy in the page’s HTML and set on a page by page basis. This method requires you to set on every page or you lose the benefit of the policy.</p>\n<p><strong>Example of a Content Security Policy set in a HTML Meta Tag</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>default-src <span class="token punctuation">\'</span>self<span class="token punctuation">\'</span>; img-src https://*; child-src <span class="token punctuation">\'</span>none<span class="token punctuation">\'</span>;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<h4>More Information:</h4>\n<ul>\n<li><a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)" rel="nofollow">OWASP Wiki - Cross Site Scripting</a></li>\n<li><a href="https://secure.php.net/manual/en/function.strip-tags.php" rel="nofollow">php.net strip_tags() manual</a></li>\n<li><a href="https://secure.php.net/manual/en/function.htmlspecialchars.php" rel="nofollow">php.net htmlspecialchars() manual</a></li>\n<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" rel="nofollow">MDN - Content Security Policy (CSP)</a></li>\n</ul>',fields:{slug:"/php/security/cross-site-scripting/"},frontmatter:{title:"Cross Site Scripting"}}},pathContext:{slug:"/php/security/cross-site-scripting/"}}}});
//# sourceMappingURL=path---php-security-cross-site-scripting-bda1cf47761842fe3fed.js.map